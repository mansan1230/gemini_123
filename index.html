<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trader æ¯æ—¥èšåˆå™¨</title>
    <style>
        /* Dark Mode Trader Style */
        body { font-family: "Roboto", "Segoe UI", sans-serif; background-color: #0f1115; color: #e0e0e0; margin: 0; padding: 20px; }
        h1, h2, h3 { color: #ffffff; margin-top: 0; }
        
        .header { text-align: center; margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 15px; }
        .timestamp { color: #888; font-size: 0.9em; }

        .container { display: grid; grid-template-columns: 2fr 1fr; gap: 20px; max-width: 1400px; margin: 0 auto; }
        
        /* å€å¡Šæ¨£å¼ */
        .box { background: #161b22; border: 1px solid #30363d; border-radius: 6px; padding: 15px; margin-bottom: 20px; }
        .box-title { font-size: 1.1em; font-weight: bold; margin-bottom: 15px; color: #58a6ff; border-bottom: 1px solid #30363d; padding-bottom: 5px; }

        /* è¡¨æ ¼æ¨£å¼ */
        table { width: 100%; border-collapse: collapse; font-size: 0.95em; }
        th { text-align: left; color: #8b949e; padding: 8px; border-bottom: 1px solid #30363d; }
        td { padding: 8px; border-bottom: 1px solid #21262d; }
        
        .price { font-family: "Courier New", monospace; font-weight: bold; }
        .up { color: #3fb950; }   /* ç¶ æ¼² */
        .down { color: #f85149; } /* ç´…è·Œ */
        
        .rsi-high { color: #f85149; font-weight: bold; } /* è¶…è²· */
        .rsi-low { color: #3fb950; font-weight: bold; }  /* è¶…è³£ */
        
        /* æ–°èåˆ—è¡¨ */
        .news-item { padding: 10px 0; border-bottom: 1px solid #21262d; }
        .news-time { color: #8b949e; font-size: 0.8em; margin-right: 10px; }
        .news-source { background: #30363d; color: #fff; padding: 2px 5px; border-radius: 4px; font-size: 0.7em; margin-right: 5px; }
        .news-title a { color: #c9d1d9; text-decoration: none; transition: 0.2s; }
        .news-title a:hover { color: #58a6ff; }

        /* éŸ¿æ‡‰å¼ */
        @media (max-width: 768px) {
            .container { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>ğŸ“ˆ Daily Trader Dashboard</h1>
        <div id="update-time" class="timestamp">Loading...</div>
    </div>

    <div class="container">
        <div class="left-col">
            
            <div class="box">
                <div class="box-title">ğŸŒ å…¨çƒæŒ‡æ•¸ & æŠ€è¡“æŒ‡æ¨™</div>
                <table>
                    <thead>
                        <tr><th>å•†å“</th><th>åƒ¹æ ¼</th><th>æ¼²è·Œ %</th><th>RSI (14)</th><th>è¨Šè™Ÿ</th></tr>
                    </thead>
                    <tbody id="indices-box"></tbody>
                </table>
            </div>

            <div class="box">
                <div class="box-title">ğŸª™ Crypto å¸‚å ´</div>
                <table>
                    <thead>
                        <tr><th>å¹£ç¨®</th><th>åƒ¹æ ¼ (USD)</th><th>æ¼²è·Œ %</th><th>RSI (14)</th><th>è¨Šè™Ÿ</th></tr>
                    </thead>
                    <tbody id="crypto-box"></tbody>
                </table>
            </div>

             <div class="box">
                <div class="box-title">ğŸŒŠ å®è§€ç¶“æ¿Ÿ (Macro)</div>
                <table>
                    <thead>
                        <tr><th>æŒ‡æ¨™</th><th>æ•¸å€¼</th><th>è®Šå‹•</th></tr>
                    </thead>
                    <tbody id="macro-box"></tbody>
                </table>
            </div>
        </div>

        <div class="right-col">
            <div class="box">
                <div class="box-title">âš¡ å¸‚å ´å¿«è¨Š (Real-time News)</div>
                <div id="news-box"></div>
            </div>
        </div>
    </div>

    <script>
        fetch('daily_news.json?t=' + new Date().getTime())
            .then(r => r.json())
            .then(data => {
                document.getElementById('update-time').textContent = "Last Updated: " + data.update_time;

                // æ¸²æŸ“å‡½æ•¸
                function renderTable(id, list, showRsi=false) {
                    const el = document.getElementById(id);
                    if(!list) return;
                    list.forEach(item => {
                        const isUp = item.change >= 0;
                        const colorClass = isUp ? 'up' : 'down';
                        const sign = isUp ? '+' : '';
                        
                        let rsiHtml = '';
                        if(showRsi) {
                            let rsiClass = '';
                            if (item.rsi > 70) rsiClass = 'rsi-high';
                            if (item.rsi < 30) rsiClass = 'rsi-low';
                            rsiHtml = `<td class="${rsiClass}">${item.rsi}</td><td><span class="${rsiClass}">${item.signal}</span></td>`;
                        } else {
                            // å®è§€æ•¸æ“šæ²’æœ‰ RSI
                            rsiHtml = '';
                        }

                        el.innerHTML += `
                            <tr>
                                <td>${item.name}</td>
                                <td class="price">${item.price.toLocaleString()}</td>
                                <td class="${colorClass}">${sign}${item.percent}%</td>
                                ${rsiHtml}
                            </tr>
                        `;
                    });
                }

                renderTable('indices-box', data.indices, true);
                renderTable('crypto-box', data.crypto, true);
                renderTable('macro-box', data.macro, false);

                // æ¸²æŸ“æ–°è
                const newsEl = document.getElementById('news-box');
                if(data.news) {
                    data.news.forEach(n => {
                        newsEl.innerHTML += `
                            <div class="news-item">
                                <span class="news-time">${n.time}</span>
                                <span class="news-source">${n.source}</span>
                                <span class="news-title"><a href="${n.link}" target="_blank">${n.title}</a></span>
                            </div>
                        `;
                    });
                }
            });
    </script>
</body>
</html>
