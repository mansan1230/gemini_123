<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Macro Trader Terminal</title>
    <style>
        /* Dark Mode Professional Style */
        body { font-family: "Roboto", "Segoe UI", sans-serif; background-color: #0b0e11; color: #c9d1d9; margin: 0; padding: 20px; }
        
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #21262d; padding-bottom: 15px; margin-bottom: 20px; }
        h1 { margin: 0; font-size: 1.5em; color: #58a6ff; }
        .timestamp { color: #8b949e; font-family: monospace; }

        /* ä½ˆå±€ï¼šå·¦é‚Šæ•¸æ“š (2æ¬„)ï¼Œå³é‚Šæ–°è (1æ¬„) */
        .main-container { display: grid; grid-template-columns: 2fr 1fr; gap: 20px; max-width: 1600px; margin: 0 auto; }
        
        /* æ•¸æ“šç¶²æ ¼ï¼šå·¦é‚Šå†åˆ†å…©æ¬„ */
        .data-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }

        .box { background: #161b22; border: 1px solid #30363d; border-radius: 6px; overflow: hidden; }
        .box-header { background: #21262d; padding: 10px 15px; font-weight: bold; font-size: 0.9em; color: #e0e0e0; border-bottom: 1px solid #30363d; display: flex; justify-content: space-between; }
        
        /* è¡¨æ ¼å„ªåŒ– */
        table { width: 100%; border-collapse: collapse; font-size: 0.85em; }
        th { text-align: left; color: #8b949e; padding: 8px 15px; background: #1c2128; font-weight: normal; }
        td { padding: 8px 15px; border-bottom: 1px solid #21262d; }
        tr:last-child td { border-bottom: none; }
        
        .price { font-family: "Courier New", monospace; font-weight: bold; color: #fff; }
        .up { color: #3fb950; }
        .down { color: #f85149; }
        
        /* RSI é¡è‰²æ¨™è¨˜ */
        .rsi-val { font-family: monospace; }
        .rsi-high { color: #f85149; font-weight: bold; } /* >70 */
        .rsi-low { color: #3fb950; font-weight: bold; }  /* <30 */
        .rsi-neu { color: #8b949e; }

        /* æ–°èå€å¡Š (Scrollable) */
        .news-scroll { max-height: 800px; overflow-y: auto; padding: 0; }
        .news-item { padding: 12px 15px; border-bottom: 1px solid #21262d; transition: background 0.2s; }
        .news-item:hover { background: #1c2128; }
        .news-meta { display: flex; justify-content: space-between; font-size: 0.75em; color: #8b949e; margin-bottom: 4px; }
        .news-source { color: #58a6ff; font-weight: bold; }
        .news-title a { color: #e0e0e0; text-decoration: none; font-size: 0.95em; line-height: 1.4; display: block; }
        .news-title a:hover { color: #58a6ff; }

        /* Scrollbar Style */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0b0e11; }
        ::-webkit-scrollbar-thumb { background: #30363d; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #58a6ff; }

        @media (max-width: 1000px) {
            .main-container { grid-template-columns: 1fr; }
            .data-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>ğŸ“Š Global Macro Trader Terminal</h1>
        <div id="update-time" class="timestamp">Initializing...</div>
    </div>

    <div class="main-container">
        
        <div class="data-grid">
            
            <div class="box">
                <div class="box-header">ğŸŒ å…¨çƒæŒ‡æ•¸ (Indices)</div>
                <table>
                    <thead><tr><th>åç¨±</th><th>ç¾åƒ¹</th><th>æ¼²è·Œ</th><th>RSI(14)</th></tr></thead>
                    <tbody id="indices-box"></tbody>
                </table>
            </div>

            <div class="box">
                <div class="box-header">ğŸª™ åŠ å¯†è²¨å¹£ (Crypto)</div>
                <table>
                    <thead><tr><th>å¹£ç¨®</th><th>åƒ¹æ ¼</th><th>æ¼²è·Œ</th><th>RSI(14)</th></tr></thead>
                    <tbody id="crypto-box"></tbody>
                </table>
            </div>

            <div class="box">
                <div class="box-header">ğŸŒŠ å®è§€ & å¤–åŒ¯ (Macro/FX)</div>
                <table>
                    <thead><tr><th>æŒ‡æ¨™</th><th>æ•¸å€¼</th><th>è®Šå‹•</th><th>ç‹€æ…‹</th></tr></thead>
                    <tbody id="macro-box"></tbody>
                </table>
            </div>

            <div class="box">
                <div class="box-header">ğŸ›¢ï¸ å•†å“ & æ¿å¡Š (Commodities)</div>
                <table>
                    <thead><tr><th>è³‡ç”¢</th><th>ç¾åƒ¹</th><th>æ¼²è·Œ</th><th>RSI(14)</th></tr></thead>
                    <tbody id="commodities-box"></tbody>
                </table>
            </div>

        </div>

        <div class="box">
            <div class="box-header">
                <span>âš¡ å¸‚å ´å¿«è¨Š (Live News)</span>
                <span style="font-size:0.8em; color:#8b949e">Top 20</span>
            </div>
            <div id="news-box" class="news-scroll">
                </div>
        </div>

    </div>

    <script>
        fetch('daily_news.json?t=' + new Date().getTime())
            .then(r => r.json())
            .then(data => {
                document.getElementById('update-time').textContent = "DATA TIME: " + data.update_time + " (HKT)";

                // é€šç”¨æ¸²æŸ“è¡¨æ ¼
                function renderTable(id, list) {
                    const el = document.getElementById(id);
                    if(!list) return;
                    list.forEach(item => {
                        const isUp = item.change >= 0;
                        const colorClass = isUp ? 'up' : 'down';
                        const sign = isUp ? '+' : '';
                        
                        // RSI è™•ç†
                        let rsiHtml = '<td class="rsi-neu">-</td>';
                        if(item.rsi && item.rsi !== "-") {
                            let rsiColor = 'rsi-neu';
                            if(item.rsi > 70) rsiColor = 'rsi-high'; // è¶…è²·
                            if(item.rsi < 30) rsiColor = 'rsi-low';  // è¶…è³£
                            rsiHtml = `<td class="rsi-val ${rsiColor}">${item.rsi}</td>`;
                        }

                        el.innerHTML += `
                            <tr>
                                <td>${item.name}</td>
                                <td class="price">${item.price.toLocaleString()}</td>
                                <td class="${colorClass}">${sign}${item.percent}%</td>
                                ${rsiHtml}
                            </tr>
                        `;
                    });
                }

                renderTable('indices-box', data.indices);
                renderTable('crypto-box', data.crypto);
                renderTable('macro-box', data.macro);
                renderTable('commodities-box', data.commodities);

                // æ¸²æŸ“æ–°è (å¸¶ Scrollbar)
                const newsEl = document.getElementById('news-box');
                if(data.news) {
                    data.news.forEach(n => {
                        newsEl.innerHTML += `
                            <div class="news-item">
                                <div class="news-meta">
                                    <span class="news-source">${n.source}</span>
                                    <span>${n.time}</span>
                                </div>
                                <div class="news-title">
                                    <a href="${n.link}" target="_blank">${n.title}</a>
                                </div>
                            </div>
                        `;
                    });
                }
            });
    </script>
</body>
</html>
